!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.RequestQueue=e()}}(function(){var define,module,exports;return function e(t,o,r){function n(s,u){if(!o[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);var p=new Error("Cannot find module '"+s+"'");throw p.code="MODULE_NOT_FOUND",p}var c=o[s]={exports:{}};t[s][0].call(c.exports,function(e){var o=t[s][1][e];return n(o?o:e)},c,c.exports,e,t,o,r)}return o[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)n(r[s]);return n}({1:[function(require,module,exports){"use strict";function getHostKey(e,t){var o,r,n="";return r="string"==typeof e||e instanceof String?parseUrl(e):e,r.protocol&&r.hostname?(r.protocol.indexOf(":")===r.protocol.length-1&&(r.protocol=r.protocol.substr(0,r.protocol.length-1)),null===r.port&&void 0!==t.defaultPorts[r.protocol]&&(r.port=t.defaultPorts[r.protocol]),t.ignoreSchemes===!1&&(n+=r.protocol+"://"),t.ignoreSubdomains===!1?n+=r.hostname:(o=parseDomain(r.hostname),n+=null===o?r.hostname:o.domain+"."+o.tld),t.ignorePorts===!1&&null!==r.port&&(n+=":"+r.port),n+="/"):!1}var parseDomain,parseUrl,_process;try{_process=eval("process")}catch(e){}"object"==typeof _process&&"[object process]"===_process.toString()?(parseDomain=require("parse-domain"),parseUrl=require("url").parse):(parseDomain=function(){return null},parseUrl=require("url-parse")),module.exports=getHostKey},{"parse-domain":void 0,url:void 0,"url-parse":5}],2:[function(e,t,o){"use strict";function r(){return Math.floor(Date.now()*Math.random()*Math.random())}t.exports=r},{}],3:[function(e,t,o){"use strict";function r(e,t){this.activeHosts={},this.items={},this.priorityQueue=[],this.activeSockets=0,this.handlers=t||{},this.options=l({},h,e),this.paused=!1}function n(e,t,o){"function"==typeof e&&(o>0?setTimeout(function(){e.apply(null,t)},o):e.apply(null,t))}function i(e,t){var o=t.priorityQueue.indexOf(e.id);return 0>o?!1:(t.priorityQueue.splice(o,1),!0)}function s(e,t){var o=c(e.url,t.options),r=e.id;return o===!1?new Error("Could not enqueue invalid URI"):((void 0===r||null===r||""===r)&&(r=f()),void 0!==t.items[r]?new Error("Could not enqueue non-unique ID"):(t.items[r]={active:!1,hostKey:o,id:r,input:e},t.priorityQueue.push(r),r))}function u(e,t){return function(){t.activeSockets--,a(e,t),p(t)}}function a(e,t){t.activeHosts[e.hostKey]--,t.activeHosts[e.hostKey]<=0&&delete t.activeHosts[e.hostKey],delete t.items[e.id],0===t.priorityQueue.length&&0===t.activeSockets&&n(t.handlers.end,[])}function p(e){var t,o,r=e.options.maxSockets-e.activeSockets,s=0;if(e.paused!==!0&&!(0>=r))for(;s<e.priorityQueue.length;)if(t=!1,o=e.items[e.priorityQueue[s]],e.options.maxSocketsPerHost>0&&(void 0===e.activeHosts[o.hostKey]?(e.activeHosts[o.hostKey]=1,t=!0):e.activeHosts[o.hostKey]<e.options.maxSocketsPerHost&&(e.activeHosts[o.hostKey]++,t=!0)),t===!0){if(e.activeSockets++,r--,o.active=!0,i(o,e),n(e.handlers.item,[o.input,u(o,e)],e.options.rateLimit),0>=r)break}else s++}var c=e("./getHostKey"),f=e("./getId"),l=e("object-assign"),h={defaultPorts:{ftp:21,http:80,https:443},ignorePorts:!0,ignoreSchemes:!0,ignoreSubdomains:!0,maxSockets:1/0,maxSocketsPerHost:1,rateLimit:0};r.prototype.dequeue=function(e){var t,o=this.items[e];return void 0===o||o.active===!0?(t=new Error("Could not dequeue non-existent ID"),n(this.handlers.error,[t,e]),t):(i(o,this),a(o,this),!0)},r.prototype.enqueue=function(e){var t;return("string"==typeof e||e instanceof String)&&(e={url:e}),t=s(e,this),t instanceof Error?n(this.handlers.error,[t,e.id,e]):p(this),t},r.prototype.length=function(){return this.priorityQueue.length},r.prototype.numActive=function(){return this.activeSockets},r.prototype.pause=function(){this.paused=!0},r.prototype.resume=function(){this.paused=!1,p(this)},t.exports=r},{"./getHostKey":1,"./getId":2,"object-assign":4}],4:[function(e,t,o){"use strict";function r(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}t.exports=Object.assign||function(e,t){for(var o,n,i=r(e),s=1;s<arguments.length;s++){o=arguments[s],n=Object.keys(Object(o));for(var u=0;u<n.length;u++)i[n[u]]=o[n[u]]}return i}},{}],5:[function(e,t,o){"use strict";function r(e,t,o){if(!(this instanceof r))return new r(e,t,o);var p,c,f,l,h=u.test(e),d=typeof t,y=this,m=0;for("object"!==d&&"string"!==d&&(o=t,t=null),o&&"function"!=typeof o&&(o=s.parse),t=i(t);m<a.length;m++)c=a[m],p=c[0],l=c[1],p!==p?y[l]=e:"string"==typeof p?~(f=e.indexOf(p))&&("number"==typeof c[2]?(y[l]=e.slice(0,f),e=e.slice(f+c[2])):(y[l]=e.slice(f),e=e.slice(0,f))):(f=p.exec(e))&&(y[l]=f[1],e=e.slice(0,e.length-f[0].length)),y[l]=y[l]||(c[3]||"port"===l&&h?t[l]||"":""),c[4]&&(y[l]=y[l].toLowerCase());o&&(y.query=o(y.query)),n(y.port,y.protocol)||(y.host=y.hostname,y.port=""),y.username=y.password="",y.auth&&(c=y.auth.split(":"),y.username=c[0]||"",y.password=c[1]||""),y.href=y.toString()}var n=e("requires-port"),i=e("./lolcation"),s=e("querystringify"),u=/^\/(?!\/)/,a=[["#","hash"],["?","query"],["//","protocol",2,1,1],["/","pathname"],["@","auth",1],[0/0,"host",void 0,1,1],[/\:(\d+)$/,"port"],[0/0,"hostname",void 0,1,1]];r.prototype.set=function(e,t,o){var r=this;return"query"===e?("string"==typeof t&&(t=(o||s.parse)(t)),r[e]=t):"port"===e?(r[e]=t,n(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="")):"hostname"===e?(r[e]=t,r.port&&(t+=":"+r.port),r.host=t):"host"===e?(r[e]=t,/\:\d+/.test(t)&&(t=t.split(":"),r.hostname=t[0],r.port=t[1])):r[e]=t,r.href=r.toString(),r},r.prototype.toString=function(e){e&&"function"==typeof e||(e=s.stringify);var t,o=this,r=o.protocol+"//";return o.username&&(r+=o.username+":"+o.password+"@"),r+=o.hostname,o.port&&(r+=":"+o.port),r+=o.pathname,o.query&&(t="object"==typeof o.query?e(o.query):o.query,r+=("?"===t.charAt(0)?"":"?")+t),o.hash&&(r+=o.hash),r},r.qs=s,r.location=i,t.exports=r},{"./lolcation":6,querystringify:7,"requires-port":8}],6:[function(e,t,o){(function(o){"use strict";var r,n={hash:1,query:1};t.exports=function(t){t=t||o.location||{},r=r||e("./");var i,s={},u=typeof t;if("blob:"===t.protocol)s=new r(unescape(t.pathname),{});else if("string"===u){s=new r(t,{});for(i in n)delete s[i]}else if("object"===u)for(i in t)i in n||(s[i]=t[i]);return s}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./":5}],7:[function(e,t,o){"use strict";function r(e){for(var t,o=/([^=?&]+)=([^&]*)/g,r={};t=o.exec(e);r[decodeURIComponent(t[1])]=decodeURIComponent(t[2]));return r}function n(e,t){t=t||"";var o=[];"string"!=typeof t&&(t="?");for(var r in e)i.call(e,r)&&o.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t+o.join("&")}var i=Object.prototype.hasOwnProperty;o.stringify=n,o.parse=r},{}],8:[function(e,t,o){"use strict";t.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 22!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},{}]},{},[3])(3)});