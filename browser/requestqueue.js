!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.RequestQueue=e()}}(function(){var define,module,exports;return function e(t,o,r){function n(i,u){if(!o[i]){if(!t[i]){var a="function"==typeof require&&require;if(!u&&a)return a(i,!0);if(s)return s(i,!0);var p=new Error("Cannot find module '"+i+"'");throw p.code="MODULE_NOT_FOUND",p}var c=o[i]={exports:{}};t[i][0].call(c.exports,function(e){var o=t[i][1][e];return n(o?o:e)},c,c.exports,e,t,o,r)}return o[i].exports}for(var s="function"==typeof require&&require,i=0;i<r.length;i++)n(r[i]);return n}({1:[function(require,module,exports){"use strict";function getHostKey(e,t){var o,r="",n=parseUrl(e);return null===n.protocol||null===n.hostname?!1:(n.protocol.indexOf(":")===n.protocol.length-1&&(n.protocol=n.protocol.substr(0,n.protocol.length-1)),null===n.port&&void 0!==t.defaultPorts[n.protocol]&&(n.port=t.defaultPorts[n.protocol]),t.ignoreSchemes===!1&&(r+=n.protocol+"://"),t.ignoreSubdomains===!1?r+=n.hostname:(o=parseDomain(n.hostname),r+=null===o?n.hostname:o.domain+"."+o.tld),t.ignorePorts===!1&&null!==n.port&&(r+=":"+n.port),r+="/")}var parseDomain,parseUrl,_process;try{_process=eval("process")}catch(e){}"object"==typeof _process&&"[object process]"===_process.toString()?(parseDomain=require("parse-domain"),parseUrl=require("url").parse):(parseDomain=function(){return null},parseUrl=require("url-parse")),module.exports=getHostKey},{"parse-domain":void 0,url:void 0,"url-parse":5}],2:[function(e,t,o){"use strict";function r(){return Math.floor(Date.now()*Math.random()*Math.random())}t.exports=r},{}],3:[function(e,t,o){"use strict";function r(e,t){this.activeHosts={},this.items={},this.priorityQueue=[],this.activeSockets=0,this.handlers=t||{},this.options=l({},f,e),this.paused=!1}function n(e,t,o){"function"==typeof e&&(o>0?setTimeout(function(){e.apply(null,t)},o):e.apply(null,t))}function s(e,t){var o=t.priorityQueue.indexOf(e.id);return 0>o?!1:(t.priorityQueue.splice(o,1),!0)}function i(e,t,o,r){var n=p(t,r.options);return n===!1?new Error("Could not enqueue invalid URI"):((void 0===e||null===e||""===e)&&(e=c()),void 0!==r.items[e]?new Error("Could not enqueue non-unique ID"):(r.items[e]={id:e,url:t,data:o||{},hostKey:n},r.priorityQueue.push(e),n))}function u(e,t){t.activeHosts[e.hostKey]--,t.activeHosts[e.hostKey]<=0&&delete t.activeHosts[e.hostKey],delete t.items[e.id]}function a(e){var t,o,r=e.options.maxSockets-e.activeSockets,i=0;if(e.paused!==!0&&!(0>=r))for(;i<e.priorityQueue.length;)if(t=!1,o=e.items[e.priorityQueue[i]],e.options.maxSocketsPerHost>0&&(void 0===e.activeHosts[o.hostKey]?(e.activeHosts[o.hostKey]=1,t=!0):e.activeHosts[o.hostKey]<e.options.maxSocketsPerHost&&(e.activeHosts[o.hostKey]++,t=!0)),t===!0){if(e.activeSockets++,r--,s(o,e),n(e.handlers.item,[o.id,o.url,o.data],e.options.rateLimit),0>=r)break}else i++}var p=e("./getHostKey"),c=e("./getId"),l=e("object-assign"),f={defaultPorts:{ftp:21,http:80,https:443},ignorePorts:!0,ignoreSchemes:!0,ignoreSubdomains:!0,maxSockets:1/0,maxSocketsPerHost:1,rateLimit:0};r.prototype.dequeue=function(e){var t,o=this.items[e];return void 0===o?(t=new Error("Could not dequeue non-existent ID"),n(this.handlers.error,[t,e]),t):(t=s(o,this),t===!1&&this.activeSockets--,u(o,this),a(this),0===this.priorityQueue.length&&0===this.activeSockets&&n(this.handlers.end,[]),!0)},r.prototype.enqueue=function(e){var t,o,r,s;return"string"==typeof e||e instanceof String?s=e:"object"==typeof e&&(t=e.data,o=e.id,s=e.url),r=i(o,s,t,this),r instanceof Error?n(this.handlers.error,[r,o,s,t]):a(this),r},r.prototype.length=function(){return this.priorityQueue.length},r.prototype.pause=function(){this.paused=!0},r.prototype.resume=function(){this.paused=!1,a(this)},t.exports=r},{"./getHostKey":1,"./getId":2,"object-assign":4}],4:[function(e,t,o){"use strict";function r(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}t.exports=Object.assign||function(e,t){for(var o,n,s=r(e),i=1;i<arguments.length;i++){o=arguments[i],n=Object.keys(Object(o));for(var u=0;u<n.length;u++)s[n[u]]=o[n[u]]}return s}},{}],5:[function(e,t,o){"use strict";function r(e,t,o){if(!(this instanceof r))return new r(e,t,o);var p,c,l,f,h=u.test(e),d=typeof t,y=this,m=0;for("object"!==d&&"string"!==d&&(o=t,t=null),o&&"function"!=typeof o&&(o=i.parse),t=s(t);m<a.length;m++)c=a[m],p=c[0],f=c[1],p!==p?y[f]=e:"string"==typeof p?~(l=e.indexOf(p))&&("number"==typeof c[2]?(y[f]=e.slice(0,l),e=e.slice(l+c[2])):(y[f]=e.slice(l),e=e.slice(0,l))):(l=p.exec(e))&&(y[f]=l[1],e=e.slice(0,e.length-l[0].length)),y[f]=y[f]||(c[3]||"port"===f&&h?t[f]||"":""),c[4]&&(y[f]=y[f].toLowerCase());o&&(y.query=o(y.query)),n(y.port,y.protocol)||(y.host=y.hostname,y.port=""),y.username=y.password="",y.auth&&(c=y.auth.split(":"),y.username=c[0]||"",y.password=c[1]||""),y.href=y.toString()}var n=e("requires-port"),s=e("./lolcation"),i=e("querystringify"),u=/^\/(?!\/)/,a=[["#","hash"],["?","query"],["//","protocol",2,1,1],["/","pathname"],["@","auth",1],[0/0,"host",void 0,1,1],[/\:(\d+)$/,"port"],[0/0,"hostname",void 0,1,1]];r.prototype.set=function(e,t,o){var r=this;return"query"===e?("string"==typeof t&&(t=(o||i.parse)(t)),r[e]=t):"port"===e?(r[e]=t,n(t,r.protocol)?t&&(r.host=r.hostname+":"+t):(r.host=r.hostname,r[e]="")):"hostname"===e?(r[e]=t,r.port&&(t+=":"+r.port),r.host=t):"host"===e?(r[e]=t,/\:\d+/.test(t)&&(t=t.split(":"),r.hostname=t[0],r.port=t[1])):r[e]=t,r.href=r.toString(),r},r.prototype.toString=function(e){e&&"function"==typeof e||(e=i.stringify);var t,o=this,r=o.protocol+"//";return o.username&&(r+=o.username+":"+o.password+"@"),r+=o.hostname,o.port&&(r+=":"+o.port),r+=o.pathname,o.query&&(t="object"==typeof o.query?e(o.query):o.query,r+=("?"===t.charAt(0)?"":"?")+t),o.hash&&(r+=o.hash),r},r.qs=i,r.location=s,t.exports=r},{"./lolcation":6,querystringify:7,"requires-port":8}],6:[function(e,t,o){(function(o){"use strict";var r,n={hash:1,query:1};t.exports=function(t){t=t||o.location||{},r=r||e("./");var s,i={},u=typeof t;if("blob:"===t.protocol)i=new r(unescape(t.pathname),{});else if("string"===u){i=new r(t,{});for(s in n)delete i[s]}else if("object"===u)for(s in t)s in n||(i[s]=t[s]);return i}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./":5}],7:[function(e,t,o){"use strict";function r(e){for(var t,o=/([^=?&]+)=([^&]*)/g,r={};t=o.exec(e);r[decodeURIComponent(t[1])]=decodeURIComponent(t[2]));return r}function n(e,t){t=t||"";var o=[];"string"!=typeof t&&(t="?");for(var r in e)s.call(e,r)&&o.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t+o.join("&")}var s=Object.prototype.hasOwnProperty;o.stringify=n,o.parse=r},{}],8:[function(e,t,o){"use strict";t.exports=function(e,t){if(t=t.split(":")[0],e=+e,!e)return!1;switch(t){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 22!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},{}]},{},[3])(3)});